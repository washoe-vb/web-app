(this["webpackJsonpwashoe-app"]=this["webpackJsonpwashoe-app"]||[]).push([[0],{254:function(e,t,n){"use strict";n.r(t);var r=n(36),c=n.n(r),i=n(40),a=n(0),o=n(201),s=n(322),j=n(50),l=n(4),d=n(5),u=n(136),b=n.n(u),O=b.a.create({baseURL:"https://api.streltsov.rocks/api/v1"});O.interceptors.request.use((function(e){return Object(d.a)(Object(d.a)({},e),{},{headers:Object(d.a)(Object(d.a)({},e.headers),{},{authorization:localStorage.getItem("token")})})}),(function(e){return Promise.reject(e)}));var x=n(203),h=n(3),p=Object(a.createContext)({}),m=function(e){var t=e.children,n=Object(a.useState)((function(){return Boolean(localStorage.token)})),r=Object(l.a)(n,2),c=r[0],i=r[1];window.onstorage=function(e){var t=e.key,n=e.newValue;return"token"===t&&i(Boolean(n))};var o=Object(j.useMutation)((function(e){return O.post("/user/login",e)}),{onSuccess:function(e){var t=e.data.token;i(Boolean(t)),localStorage.setItem("token",t)},onError:function(){x.b.error("Something went wrong")}}),s=o.mutate,d=o.isLoading,u=Object(j.useMutation)((function(e){return O.post("/user/signup",e)}),{onSuccess:function(e){var t=e.data.token;i(Boolean(t)),localStorage.setItem("token",t)},onError:function(){x.b.error("Something went wrong")}}),b=u.mutate,m={isAuthenticated:c,isLoggingIn:d,logIn:s,isSigningUp:u.isLoading,signUp:b};return Object(h.jsx)(p.Provider,{value:m,children:t})},f=function(){return Object(a.useContext)(p)},g=n(311),v=n(310),w=n(16),y=n(328),k=n(326),S=n(327),E=n(324),I=function(){return Object(h.jsxs)(k.a,{position:"fixed",component:"nav",children:[Object(h.jsxs)(S.a,{children:[Object(h.jsx)(E.a,{color:"inherit",component:i.b,to:"/",children:"Washoe"}),Object(h.jsxs)(y.a,{ml:"auto",display:"flex",gap:1,children:[Object(h.jsx)(E.a,{color:"inherit",component:i.b,to:"/add-word",children:"Add Word"}),Object(h.jsx)(E.a,{color:"inherit",component:i.b,to:"/my-words",children:"My Words"})]})]}),Object(h.jsx)(v.a,{})]})},C=function(){return f().isAuthenticated?Object(h.jsxs)(y.a,{sx:{marginTop:"64px"},children:[Object(h.jsx)(I,{}),Object(h.jsx)(w.b,{})]}):Object(h.jsx)(w.b,{})},P=n(317),L=n(329),B=n(316),A=n(320),F=n(202),T=n(344),U=n(345),W=P.a.Title,M=P.a.Text,Q=function(e){var t=e.onLogIn;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(L.b,{direction:"vertical",align:"center",style:{width:"100%",marginBottom:"16px"},children:[Object(h.jsx)(W,{level:3,children:"Log In"}),Object(h.jsx)(M,{type:"secondary",children:"to continue to Washoe"})]}),Object(h.jsxs)(B.a,{onFinish:t,children:[Object(h.jsx)(B.a.Item,{name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}],children:Object(h.jsx)(A.a,{prefix:Object(h.jsx)(T.a,{}),placeholder:"Email"})}),Object(h.jsx)(B.a.Item,{name:"password",rules:[{required:!0,message:"Please input your Password!"}],children:Object(h.jsx)(A.a.Password,{prefix:Object(h.jsx)(U.a,{}),placeholder:"Password"})}),Object(h.jsx)(B.a.Item,{children:Object(h.jsx)(F.a,{type:"primary",htmlType:"submit",style:{width:"100%"},children:"Log In"})})]}),Object(h.jsx)(L.b,{direction:"vertical",align:"center",style:{width:"100%"},children:Object(h.jsxs)(M,{children:["New to Washoe? ",Object(h.jsx)(i.b,{to:"/signup",children:"Create an account"})]})})]})};var D=function(){var e=f(),t=e.logIn;return function(e){var t,n,r=Object(w.m)().state,c=Object(w.o)(),i=(null===r||void 0===r||null===(t=r.from)||void 0===t?void 0:t.pathname)+(null===r||void 0===r||null===(n=r.from)||void 0===n?void 0:n.search)||"/";Object(a.useEffect)((function(){e&&c(i,{replace:!0})}),[e,i,c])}(e.isAuthenticated),Object(h.jsx)(Q,{onLogIn:t})},z=P.a.Title,q=P.a.Text,N=function(e){var t=e.onSignUp;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(L.b,{direction:"vertical",align:"center",style:{width:"100%",marginBottom:"16px"},children:[Object(h.jsx)(z,{level:3,children:"Sign Up"}),Object(h.jsx)(q,{type:"secondary",children:"to continue to Washoe"})]}),Object(h.jsxs)(B.a,{onFinish:t,children:[Object(h.jsx)(B.a.Item,{name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}],children:Object(h.jsx)(A.a,{prefix:Object(h.jsx)(T.a,{}),placeholder:"Email"})}),Object(h.jsx)(B.a.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],hasFeedback:!0,children:Object(h.jsx)(A.a.Password,{prefix:Object(h.jsx)(U.a,{}),placeholder:"Password"})}),Object(h.jsx)(B.a.Item,{children:Object(h.jsx)(F.a,{type:"primary",htmlType:"submit",style:{width:"100%"},children:"Sign Up"})})]}),Object(h.jsx)(L.b,{direction:"vertical",align:"center",style:{width:"100%"},children:Object(h.jsxs)(q,{children:["Already have an account? ",Object(h.jsx)(i.b,{to:"/login",children:"Log In"})]})})]})},_=function(){var e=f().signUp;return Object(h.jsx)(N,{onSignUp:e})},J=function(){return Object(j.useMutation)((function(e){return O.post("/word/create",e)}))},R=n(2);function V(e){var t=Object(i.c)(),n=Object(l.a)(t,2),r=n[0],c=n[1];return[r.get(e)||"",function(t){var n=Object.fromEntries(r),i=Object(R.a)({},e,t),a=Object(d.a)(Object(d.a)({},n),i);c(a,{replace:!0})}]}var G=function(e){return Object(j.useQuery)(["get-definition",e],(function(){return function(e){return b.a.get("https://api.dictionaryapi.dev/api/v2/entries/en/"+e).then((function(e){return e.data}))}(e)}),{refetchOnWindowFocus:!1,cacheTime:1/0,enabled:Boolean(e),initialData:[]})},H={primary:"primary",danger:"error"},K=function(e){var t=e.children,n=e.onClick,r=e.color;return Object(h.jsx)(E.a,{variant:"contained",color:H[r||"primary"],size:"large",onClick:n,children:t})},X=n(197),Y=n.n(X),Z=n(318),$=n(331),ee=n(333),te=n(334),ne=n(330);function re(e){var t=e.children,n=e.onClose,r=e.isOpen,c=e.title,i=Object(g.a)((function(e){return e.breakpoints.down("sm")}));return Object(h.jsx)(Z.a,{open:r,children:Object(h.jsxs)(ne.a,{sx:i?{position:"absolute",inset:"0 0 0 0",bgcolor:"background.paper",p:1}:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",p:4},children:[Object(h.jsx)($.a,{action:n&&Object(h.jsx)(ee.a,{onClick:n,children:Object(h.jsx)(Y.a,{})}),title:c}),Object(h.jsx)(te.a,{sx:{display:"flex",flexDirection:"column",gap:"24px"},children:t})]})})}var ce=n(315);function ie(e){return Object(h.jsx)(ce.a,Object(d.a)(Object(d.a)({},e),{},{multiline:!0,variant:"outlined"}))}var ae,oe=function(){var e=V("word"),t=Object(l.a)(e,2),n=t[0],r=t[1],c=V("definition"),i=Object(l.a)(c,2),a=i[0],o=i[1],s=V("example"),j=Object(l.a)(s,2),d=j[0],u=j[1];return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(ie,{value:n,onChange:function(e){var t=e.target;return r(t.value)}}),Object(h.jsx)(ie,{value:a,onChange:function(e){var t=e.target;return o(t.value)}}),Object(h.jsx)(ie,{value:d,onChange:function(e){var t=e.target;return u(t.value)}})]})},se=function(){var e=J().mutate,t=Object(i.c)(),n=Object(l.a)(t,2),r=n[0],c=n[1];return Object(h.jsxs)(re,{title:"Add word",isOpen:!0,children:[Object(h.jsx)(oe,{}),Object(h.jsx)(K,{onClick:function(){var t=Object.fromEntries(r.entries()),n=t.word,i=t.definition,a=t.example;e(function(e){var t=e.word,n=e.definition,r=e.example;return Object(d.a)(Object(d.a)({word:t},n?{definition:n}:{}),r?{example:r}:{})}({word:n,definition:i,example:a}),{onSuccess:function(){return c({})}})},children:"Add"})]})},je=n(95),le=new j.QueryClient,de=n(198),ue=n(319),be=n(337),Oe=n(340),xe=n(342),he=n(336),pe=n(338),me=n(339),fe=n(323),ge=n(341),ve=n(8);function we(e,t){var n=e.data.count,r=25*t.length;if(n>r)return r}var ye=function(){var e=Object(j.useInfiniteQuery)("words",(function(e){var t=e.pageParam,n=void 0===t?0:t;return O.get("/word",{params:{skip:n,limit:25}})}),{getNextPageParam:we}),t=e.data,n=e.fetchNextPage,r=e.hasNextPage,c=e.refetch,a=(null===t||void 0===t?void 0:t.pages.reduce((function(e,t){return e.concat(t.data.words)}),[]))||[],o=Object(j.useMutation)((function(e){return O.delete("/word/delete?id=".concat(e))})).mutate,s=Object(j.useMutation)((function(e){return O.patch("/word/update",e)}),{onSuccess:function(){return le.invalidateQueries("words",{refetchInactive:!0})}}),d=s.mutate,u=Object(i.c)(),b=Object(l.a)(u,2),x=b[0],p=b[1],m=Object.fromEntries(x.entries()),f=m._id,g=m.word,v=m.definition,w=m.example;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(re,{title:"Edit word",isOpen:Boolean(f),onClose:function(){return p({})},children:[Object(h.jsx)(oe,{}),Object(h.jsx)(K,{color:"danger",onClick:function(){o(f,{onSuccess:function(){c()}}),p({})},children:"Delete"}),Object(h.jsx)(K,{onClick:function(){d({_id:f,word:g,definition:v,example:w},{onSuccess:function(){c()}}),p({})},children:"Save"})]}),Object(h.jsx)(de.a,{dataLength:a.length,next:n,hasMore:Boolean(r),loader:Object(h.jsx)(ue.a,{active:!0}),children:Object(h.jsx)(he.a,{component:fe.a,sx:{padding:0},children:Object(h.jsxs)(be.a,{size:"small",children:[Object(h.jsx)(pe.a,{children:Object(h.jsxs)(me.a,{children:[Object(h.jsx)(ke,{children:"Word"}),Object(h.jsx)(ke,{children:"Definition/Example"})]})}),Object(h.jsx)(Oe.a,{children:a.map((function(e){var t=e._id,n=e.word,r=e.definition,c=void 0===r?"":r,i=e.example,a=void 0===i?"":i;return Object(h.jsxs)(me.a,{onClick:function(){return p(new URLSearchParams({_id:t,word:n,definition:c,example:a}))},children:[Object(h.jsx)(ke,{component:"th",scope:"row",children:n}),Object(h.jsxs)(ke,{children:[c,Boolean(c&&a)&&Object(h.jsx)(ge.a,{sx:{margin:"4px"}}),Object(h.jsx)("i",{children:a})]})]},t)}))})]})})})]})},ke=Object(ve.a)(xe.a)(ae||(ae=Object(je.a)(["\n  font-size: 12px;\n  padding: 4px 8px;\n"]))),Se=n(35),Ee=n(18),Ie=n(31),Ce=n(332),Pe=n(343),Le=function(e){var t=e.word,n=e.definition,r=e.example,c=e.synonyms,a=Boolean(c.length)?" : "+JSON.stringify(c):"",o=": ".concat(n.toLowerCase()).concat(a),s="/add-word?word=".concat(t,"&definition=").concat(o||"","&example=").concat(r||""),j=J(),l=j.mutate,d=j.isLoading;function u(){return(u=Object(Ie.a)(Object(Ee.a)().mark((function e(){return Object(Ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l({word:t,definition:o,example:r});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(h.jsx)(y.a,{sx:{mb:1},children:Object(h.jsxs)(ne.a,{variant:"outlined",children:[Object(h.jsxs)(te.a,{children:[Object(h.jsx)(Ce.a,{variant:"body1",children:o}),r&&Object(h.jsx)(Ce.a,{sx:{mb:1.5},variant:"body2",color:"text.secondary",children:Object(h.jsx)("ul",{children:Object(h.jsx)("li",{children:Object(h.jsx)("i",{children:r})})})})]}),Object(h.jsxs)(Pe.a,{children:[Object(h.jsx)(E.a,{component:i.b,to:s,size:"large",children:"Add"}),Object(h.jsx)(E.a,{disabled:d,onClick:function(){return u.apply(this,arguments)},size:"large",children:d?"Adding...":"Quick Add"})]})]})})},Be=n(335),Ae=["word"],Fe=function(e){var t=e.isLoading,n=e.isError,r=e.isSuccess,c=e.data;return n?Object(h.jsx)("span",{children:"Error occured"}):t?Object(h.jsx)("span",{children:"Loading..."}):c.length?r?Object(h.jsx)(h.Fragment,{children:c.map((function(e){var t=e.word;return Object(Se.a)(e,Ae).meanings.map((function(e,n){return Object(h.jsxs)(y.a,{children:[Object(h.jsx)(Ce.a,{variant:"h5",children:e.partOfSpeech}),e.definitions.map((function(e,n){return Object(h.jsx)(Le,{word:t,definition:e.definition,synonyms:e.synonyms,example:e.example},n)}))]},n)}))}))}):Object(h.jsx)("span",{children:"Enter some word to see it definition"}):Object(h.jsx)("span",{children:'"Empty data'})},Te=function(){var e=V("word"),t=Object(l.a)(e,2),n=t[0],r=t[1],c=G(n),i=c.isError,a=c.isLoading,o=c.isSuccess,s=c.data;return Object(h.jsxs)(y.a,{children:[Object(h.jsx)("form",{onSubmit:function(e){e.preventDefault();var t=new FormData(e.currentTarget);r(t.get("word"))},children:Object(h.jsx)(Be.a,{fullWidth:!0,children:Object(h.jsx)(ce.a,{variant:"standard",name:"word",defaultValue:n,autoFocus:!0,margin:"normal"})})}),Object(h.jsx)(Fe,{isLoading:a,isError:i,isSuccess:o,data:s})]})};function Ue(e){var t=e.children,n=Object(w.m)();return f().isAuthenticated?t:Object(h.jsx)(w.a,{to:"/login",state:{from:n}})}var We=function(){return Object(h.jsx)(w.e,{children:Object(h.jsxs)(w.c,{element:Object(h.jsx)(C,{}),children:[Object(h.jsx)(w.c,{path:"/",element:Object(h.jsx)(Ue,{children:Object(h.jsx)(Te,{})})}),Object(h.jsx)(w.c,{path:"/add-word",element:Object(h.jsx)(Ue,{children:Object(h.jsx)(se,{})})}),Object(h.jsx)(w.c,{path:"/my-words",element:Object(h.jsx)(Ue,{children:Object(h.jsx)(ye,{})})}),Object(h.jsx)(w.c,{path:"/dictionary",element:Object(h.jsx)(Te,{})}),Object(h.jsx)(w.c,{path:"/signup",element:Object(h.jsx)(_,{})}),Object(h.jsx)(w.c,{path:"/login",element:Object(h.jsx)(D,{})})]})})},Me=n(199),Qe=function(){var e=Object(g.a)("(prefers-color-scheme: dark)"),t=Object(o.a)({palette:{mode:e?"dark":"light"}}),n=new j.QueryClient;return Object(h.jsx)(a.StrictMode,{children:Object(h.jsxs)(s.a,{theme:t,children:[Object(h.jsxs)(j.QueryClientProvider,{client:n,children:[Object(h.jsx)(m,{children:Object(h.jsx)(i.a,{children:Object(h.jsx)(We,{})})}),Object(h.jsx)(Me.ReactQueryDevtools,{initialIsOpen:!1})]}),Object(h.jsx)(v.a,{})]})})};c.a.render(Object(h.jsx)(Qe,{}),document.getElementById("root"))}},[[254,1,2]]]);
//# sourceMappingURL=main.38827725.chunk.js.map