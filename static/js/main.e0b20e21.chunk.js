(this["webpackJsonpwashoe-app"]=this["webpackJsonpwashoe-app"]||[]).push([[0],{351:function(e,t,n){},352:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(44),i=n.n(c),s=n(67),o=n(4),d=n(18),j=n(227),l=n(406),u=n(70),b=n(3),h=n(150),O=n.n(h),x=O.a.create({baseURL:"https://api.streltsov.rocks:3001/api/v1"});x.interceptors.request.use((function(e){return Object(b.a)(Object(b.a)({},e),{},{headers:Object(b.a)(Object(b.a)({},e.headers),{},{authorization:localStorage.getItem("token")})})}),(function(e){return Promise.reject(e)}));var m=n(229),p=n(5),f=Object(r.createContext)({}),g=function(e){var t=e.children,n=Object(r.useState)((function(){return Boolean(localStorage.token)})),a=Object(o.a)(n,2),c=a[0],i=a[1];window.onstorage=function(e){var t=e.key,n=e.newValue;return"token"===t&&i(Boolean(n))};var s=Object(u.useMutation)((function(e){return x.post("/user/login",e)}),{onSuccess:function(e){var t=e.data.token;i(Boolean(t)),localStorage.setItem("token",t)},onError:function(){m.b.error("Something went wrong")}}),d=s.mutate,j=s.isLoading,l=Object(u.useMutation)((function(e){return x.post("/user/signup",e)}),{onSuccess:function(e){var t=e.data.token;i(Boolean(t)),localStorage.setItem("token",t)},onError:function(){m.b.error("Something went wrong")}}),b=l.mutate,h={isAuthenticated:c,isLoggingIn:j,logIn:d,isSigningUp:l.isLoading,signUp:b};return Object(p.jsx)(f.Provider,{value:h,children:t})},v=function(){return Object(r.useContext)(f)},w=n(407),y=function(e){var t=e.children;return Object(p.jsx)(w.a,{children:t})},S=n(396),I=n(405),k=n(400),E=n(232),L=n(399),P=n(228),T=n(98),F=n(413),A=n(414),B=k.a.Title,C=k.a.Text,W=function(e){var t=e.onLogIn;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(E.b,{direction:"vertical",align:"center",style:{width:"100%",marginBottom:"16px"},children:[Object(p.jsx)(B,{level:3,children:"Log In"}),Object(p.jsx)(C,{type:"secondary",children:"to continue to Washoe"})]}),Object(p.jsxs)(L.a,{onFinish:t,children:[Object(p.jsx)(L.a.Item,{name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}],children:Object(p.jsx)(P.a,{prefix:Object(p.jsx)(F.a,{}),placeholder:"Email"})}),Object(p.jsx)(L.a.Item,{name:"password",rules:[{required:!0,message:"Please input your Password!"}],children:Object(p.jsx)(P.a.Password,{prefix:Object(p.jsx)(A.a,{}),placeholder:"Password"})}),Object(p.jsx)(L.a.Item,{children:Object(p.jsx)(T.a,{type:"primary",htmlType:"submit",style:{width:"100%"},children:"Log In"})})]}),Object(p.jsx)(E.b,{direction:"vertical",align:"center",style:{width:"100%"},children:Object(p.jsxs)(C,{children:["New to Washoe? ",Object(p.jsx)(s.b,{to:"/signup",children:"Create an account"})]})})]})};var q=function(){var e=v(),t=e.logIn;return function(e){var t,n,a=Object(d.l)().state,c=Object(d.n)(),i=(null===a||void 0===a||null===(t=a.from)||void 0===t?void 0:t.pathname)+(null===a||void 0===a||null===(n=a.from)||void 0===n?void 0:n.search)||"/";Object(r.useEffect)((function(){e&&c(i,{replace:!0})}),[e,i,c])}(e.isAuthenticated),Object(p.jsx)(W,{onLogIn:t})},M=k.a.Title,U=k.a.Text,D=function(e){var t=e.onSignUp;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(E.b,{direction:"vertical",align:"center",style:{width:"100%",marginBottom:"16px"},children:[Object(p.jsx)(M,{level:3,children:"Sign Up"}),Object(p.jsx)(U,{type:"secondary",children:"to continue to Washoe"})]}),Object(p.jsxs)(L.a,{onFinish:t,children:[Object(p.jsx)(L.a.Item,{name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}],children:Object(p.jsx)(P.a,{prefix:Object(p.jsx)(F.a,{}),placeholder:"Email"})}),Object(p.jsx)(L.a.Item,{name:"password",rules:[{required:!0,message:"Please input your password!"}],hasFeedback:!0,children:Object(p.jsx)(P.a.Password,{prefix:Object(p.jsx)(A.a,{}),placeholder:"Password"})}),Object(p.jsx)(L.a.Item,{children:Object(p.jsx)(T.a,{type:"primary",htmlType:"submit",style:{width:"100%"},children:"Sign Up"})})]}),Object(p.jsx)(E.b,{direction:"vertical",align:"center",style:{width:"100%"},children:Object(p.jsxs)(U,{children:["Already have an account? ",Object(p.jsx)(s.b,{to:"/login",children:"Log In"})]})})]})},N=function(){var e=v().signUp;return Object(p.jsx)(D,{onSignUp:e})},Q=function(){return Object(u.useMutation)((function(e){return x.post("/word/create",e)}))},V=n(2);function z(e){var t=Object(s.c)(),n=Object(o.a)(t,2),r=n[0],a=n[1];return[r.get(e)||"",function(t){var n=Object.fromEntries(r),c=Object(V.a)({},e,t),i=Object(b.a)(Object(b.a)({},n),c);a(i,{replace:!0})}]}var J=function(e){return Object(u.useQuery)(["get-definition",e],(function(){return function(e){return O.a.get("https://api.dictionaryapi.dev/api/v2/entries/en/"+e).then((function(e){return e.data}))}(e)}),{refetchOnWindowFocus:!1,cacheTime:1/0,enabled:Boolean(e),initialData:[]})},H=k.a.Title,K=function(){var e=z("word"),t=Object(o.a)(e,2),n=t[0],r=t[1],a=z("definition"),c=Object(o.a)(a,2),i=c[0],s=c[1],d=z("example"),j=Object(o.a)(d,2),l=j[0],u=j[1],h=Q(),O=h.mutate,x=h.isLoading,f=L.a.useForm(),g=Object(o.a)(f,1)[0];return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(xe,{}),Object(p.jsxs)(y,{children:[Object(p.jsx)(H,{level:3,children:"Add a Word"}),Object(p.jsxs)(L.a,{form:g,initialValues:{word:n,definition:i,example:l},onFinish:function(e){O(function(e){var t=e.word,n=e.definition,r=e.example;return Object(b.a)(Object(b.a)({word:t},n?{definition:n}:{}),r?{example:r}:{})}(e),{onSuccess:function(){m.b.success("Success!"),g.resetFields()},onError:function(){m.b.error("Something went wrong")}})},children:[Object(p.jsx)(L.a.Item,{name:"word",required:!0,children:Object(p.jsx)(P.a,{onChange:function(e){var t=e.currentTarget;return r(t.value)},disabled:x,placeholder:"Word"})}),Object(p.jsx)(L.a.Item,{name:"definition",required:!0,children:Object(p.jsx)(P.a.TextArea,{onChange:function(e){var t=e.currentTarget;return s(t.value)},disabled:x,placeholder:"Definition"})}),Object(p.jsx)(L.a.Item,{name:"example",required:!0,children:Object(p.jsx)(P.a.TextArea,{onChange:function(e){var t=e.currentTarget;return u(t.value)},disabled:x,placeholder:"Example"})}),Object(p.jsx)(T.a,{loading:x,type:"primary",htmlType:"submit",style:{width:"100%"},children:"Add"})]})]})]})},R=n(222),_=n(401),G=n(397),X=[{title:Object(p.jsx)("strong",{children:"Word"}),dataIndex:"word",key:"word"},{title:Object(p.jsx)("strong",{children:"Definition"}),dataIndex:"definition",key:"definition"},{title:Object(p.jsx)("strong",{children:"Example"}),dataIndex:"example",key:"example"}];function Y(e,t){var n=e.data.count,r=25*t.length;if(n>r)return r}var Z=function(){var e=Object(u.useInfiniteQuery)("words",(function(e){var t=e.pageParam,n=void 0===t?0:t;return x.get("/word",{params:{skip:n,limit:25}})}),{getNextPageParam:Y}),t=e.data,n=e.fetchNextPage,r=e.hasNextPage,a=e.status,c=(null===t||void 0===t?void 0:t.pages.reduce((function(e,t){return e.concat(t.data.words)}),[]))||[];return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(xe,{}),Object(p.jsx)(R.a,{dataLength:c.length,next:n,hasMore:Boolean(r),loader:Object(p.jsx)(_.a,{active:!0}),children:Object(p.jsx)(G.a,{columns:X,dataSource:c,rowKey:function(e){return e._id},pagination:!1,bordered:!0,loading:"loading"===a,sticky:!0})})]})},$=n(10),ee=n(21),te=n(40),ne=n(408),re=n(410),ae=n(411),ce=n(412),ie=n(402),se=function(e){var t=e.word,n=e.definition,r=e.example,a=e.synonyms,c=Boolean(a.length)?" : "+JSON.stringify(a):"",i=": ".concat(n.toLowerCase()).concat(c),o="/add-word?word=".concat(t,"&definition=").concat(i||"","&example=").concat(r||""),d=Q(),j=d.mutate,l=d.isLoading;function u(){return(u=Object(te.a)(Object(ee.a)().mark((function e(){return Object(ee.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j({word:t,definition:i,example:r});case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(p.jsx)(w.a,{sx:{mb:1},children:Object(p.jsxs)(ne.a,{variant:"outlined",children:[Object(p.jsxs)(re.a,{children:[Object(p.jsx)(ae.a,{variant:"body1",children:i}),r&&Object(p.jsx)(ae.a,{sx:{mb:1.5},variant:"body2",color:"text.secondary",children:Object(p.jsx)("ul",{children:Object(p.jsx)("li",{children:Object(p.jsx)("i",{children:r})})})})]}),Object(p.jsxs)(ce.a,{children:[Object(p.jsx)(ie.a,{component:s.b,to:o,size:"large",children:"Add"}),Object(p.jsx)(ie.a,{disabled:l,onClick:function(){return u.apply(this,arguments)},size:"large",children:l?"Adding...":"Quick Add"})]})]})})},oe=n(403),de=n(398),je=["word"],le=function(e){var t=e.isLoading,n=e.isError,r=e.isSuccess,a=e.data;return n?Object(p.jsx)("span",{children:"Error occured"}):t?Object(p.jsx)("span",{children:"Loading..."}):a.length?r?Object(p.jsx)(p.Fragment,{children:a.map((function(e){var t=e.word;return Object($.a)(e,je).meanings.map((function(e,n){return Object(p.jsxs)(w.a,{children:[Object(p.jsx)(ae.a,{variant:"h5",children:e.partOfSpeech}),e.definitions.map((function(e,n){return Object(p.jsx)(se,{word:t,definition:e.definition,synonyms:e.synonyms,example:e.example},n)}))]},n)}))}))}):Object(p.jsx)("span",{children:"Enter some word to see it definition"}):Object(p.jsx)("span",{children:'"Empty data'})},ue=function(){var e=z("word"),t=Object(o.a)(e,2),n=t[0],r=t[1],a=J(n),c=a.isError,i=a.isLoading,s=a.isSuccess,d=a.data;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(xe,{}),Object(p.jsx)(w.a,{sx:{mb:4},component:"form",onSubmit:function(e){e.preventDefault();var t=new FormData(e.currentTarget);r(t.get("word"))},noValidate:!0,children:Object(p.jsx)(oe.a,{fullWidth:!0,children:Object(p.jsx)(de.a,{variant:"standard",name:"word",defaultValue:n,autoFocus:!0,margin:"normal"})})}),Object(p.jsx)(le,{isLoading:i,isError:c,isSuccess:s,data:d})]})};function be(){return v().isAuthenticated?Object(p.jsx)(w.a,{sx:{p:2},children:Object(p.jsx)(d.b,{})}):Object(p.jsx)(y,{children:Object(p.jsx)(d.b,{})})}function he(e){var t=e.children,n=Object(d.l)();return v().isAuthenticated?t:Object(p.jsx)(d.a,{to:"/login",state:{from:n}})}var Oe=function(){return Object(p.jsx)(ue,{})},xe=function(){return Object(p.jsxs)(S.a,{direction:"row",gap:2,mb:4,children:[Object(p.jsx)(I.a,{href:"/",children:"Home"}),Object(p.jsx)(I.a,{href:"add-word",children:"Add Word"}),Object(p.jsx)(I.a,{href:"my-words",children:"My Words"})]})},me=function(){var e=new u.QueryClient,t=Object(r.useState)("dark"),n=Object(o.a)(t,2),a=n[0],c=n[1];matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(function(e){return c(e.matches?"dark":"light")}));var i=Object(r.useMemo)((function(){return Object(j.a)({palette:{mode:a}})}),[a]);return Object(p.jsx)(l.a,{theme:i,children:Object(p.jsx)(u.QueryClientProvider,{client:e,children:Object(p.jsx)(g,{children:Object(p.jsx)(d.e,{children:Object(p.jsxs)(d.c,{element:Object(p.jsx)(be,{}),children:[Object(p.jsx)(d.c,{path:"/",element:Object(p.jsx)(he,{children:Object(p.jsx)(Oe,{})})}),Object(p.jsx)(d.c,{path:"/add-word",element:Object(p.jsx)(he,{children:Object(p.jsx)(K,{})})}),Object(p.jsx)(d.c,{path:"/my-words",element:Object(p.jsx)(he,{children:Object(p.jsx)(Z,{})})}),Object(p.jsx)(d.c,{path:"/dictionary",element:Object(p.jsx)(ue,{})}),Object(p.jsx)(d.c,{path:"/signup",element:Object(p.jsx)(N,{})}),Object(p.jsx)(d.c,{path:"/login",element:Object(p.jsx)(q,{})})]})})})})})},pe=(n(351),document.getElementById("root"));i.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(s.a,{children:Object(p.jsx)(me,{})})}),pe)}},[[352,1,2]]]);
//# sourceMappingURL=main.e0b20e21.chunk.js.map